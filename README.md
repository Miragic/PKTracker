# 微信群 PK 打卡插件

## 简介

基于 `dify-on-wechat` 项目的一个微信群 PK 打卡插件。该插件支持群内打卡任务、积分竞赛和管理员管理功能，旨在通过好友互相监督打卡，提升群内互动性和活跃度。插件利用
`dify-on-wechat` 微信机器人的特性，结合 SQLite 实现持久化操作。

## 功能特性

### 基础打卡功能

- **打卡指令**：`PKTracker [任务名称] 打卡内容`
- **查看任务**：
    - 任务列表：`PKTracker 任务列表`
    - 任务详情：`PKTracker 任务详情 [任务名称]`
    - 积分排名：`PKTracker 积分榜 [任务名称]`（可选任务名称）
    - 积分详情：`PKTracker 积分详情 [用户名] p[页码]`（支持分页查看）

### 奖励机制

- **基础打卡分**：每次打卡获得基础积分（可配置）
- **首次打卡奖励**：每日首次打卡可获得额外积分
- **连续打卡奖励**：连续打卡达到要求可获得额外积分
- **周冠军奖励**：每周打卡次数最多的用户可获得额外积分
- **月冠军奖励**：每月打卡次数最多的用户可获得额外积分

### 管理功能

1. **任务管理**
    - 创建任务：`PKTracker 创建任务 [任务名称]`
    - 删除任务：`PKTracker 删除任务 [任务名称]`
    - 设置任务：`PKTracker 设置任务 [任务名称] s[开/关] b[分数]`
    - 设置打卡次数：`PKTracker 设置次数 [任务名称] [次数]`

2. **提醒设置**
    - 设置提醒：`PKTracker 设置提醒时间 [任务名称] time[HH:MM] t[提醒内容]`

3. **奖励设置**
    - 连续打卡：`PKTracker 设置连续打卡 [任务名称] s[开/关] b[分数]`
    - 首次打卡：`PKTracker 设置首次打卡 [任务名称] s[开/关] b[分数]`
    - 周冠军：`PKTracker 设置周冠军 [任务名称] s[开/关] b[分数]`
    - 月冠军：`PKTracker 设置月冠军 [任务名称] s[开/关] b[分数]`

4. **管理员管理**
    - 查看管理员：`PKTracker 查看管理员`
    - 添加管理员：`PKTracker 添加管理员 [用户名]`（仅超管）
    - 取消管理员：`PKTracker 取消管理员 [用户名]`（仅超管）

### 自动化功能

- **每日排行榜**：每天自动发送（可配置时间）
- **周冠军公告**：每周日晚自动结算
- **月冠军公告**：每月最后一天自动结算
- **定时提醒**：根据任务设置的时间自动发送提醒

## 配置说明

### config.json

```json
{
    "db_path": "pkTracker.db",        // 数据库文件名
    "super_admins": ["admin1"],       // 超级管理员列表
    "daily_ranking_time": "09:10"     // 每日排行榜发送时间
}
```

